### **Application of OPTICS and ensemble learning for Database Intrusion Detection**

#### **1. Актуальность и проблема**
*   **Важность баз данных:** Базы данных (БД) являются ядром информационных систем, хранят критически важные данные (финансы, клиенты, научные данные).
*   **Угрозы:** Организации несут значительные убытки (≈5% годового дохода по данным ACFE, 2016) из-за мошенничества и атак. Атаки делятся на:
    *   **Внешние:** Использование уязвимостей, слабых паролей.
    *   **Внутренние:** Злоупотребление правами доступа инсайдерами.
*   **Недостаточность традиционных мер защиты:** Аутентификация, контроль доступа, межсетевые экраны (firewall), шифрование не способны полностью предотвратить все виды атак, особенно инсайдерские.

#### **2. Проблема существующих систем обнаружения вторжений (DIDS)**
*   **Эффект базовой частоты (Base-rate fallacy):** Даже при высокой точности обнаружения атак, большое количество ложных срабатываний (False Positives) резко снижает эффективность системы.
*   **Ключевые требования к DIDS:** Высокая точность, низкий уровень ложных срабатываний, надежность, скорость и работа в реальном времени.

#### **3. Предложенное решение**
Для решения указанных проблем предлагается гибридная система, сочетающая:
1.  **Кластеризацию OPTICS:** Для построения профилей нормального поведения пользователей и первичного выявления аномалий (выбросов).
2.  **Ансамблевое обучение (Ensemble Learning):** Для точной классификации подозрительных транзакций, отсеянных на первом этапе, что позволяет снизить уровень ложных тревог.

#### **4. Методология**

**Архитектура системы состоит из трех основных модулей:**

**A. Activity Builder (Модуль построения активности)**
*   **Цель:** Построение профилей пользователей на основе их прошлых транзакций.
*   **Представление транзакции:** Каждая транзакция описывается кортежем:
    `<u_id, transaction_id, query_type, table_list, att_list, time_slot, loc, time_gap>`
    *   `u_id, transaction_id`: Уникальные идентификаторы пользователя и транзакции.
    *   `query_type`: Тип SQL-запроса (SELECT, UPDATE и т.д.).
    *   `table_list, att_list`: Списки accessed таблиц и атрибутов.
    *   `time_slot`: Временной интервал (день разбит на 48 слотов по 30 минут).
    *   `loc`: Местоположение (1-офис, 2-дом, 3-другое).
    *   `time_gap`: Время между последовательными запросами пользователя.
*   **Использование OPTICS:**
    *   **Входные параметры:** `ε` (радиус окрестности) и `MinPts` (минимальное число точек для образования кластера).
    *   **Процесс:** Алгоритм вычисляет `core-distance (cd)` и `reachability-distance (rd)` для каждой точки. Точки с близкими `rd` значениями образуют кластеры (профили нормального поведения).
    *   **Outlier Factor (OF):** Коэффициент выброса, вычисляемый для каждой транзакции. Если `OF < 1`, транзакция считается нормальной.

**B. User Activity Database (UAD, База активности пользователей)**
*   **Цель:** Хранилище исторических данных о транзакциях.
*   **Состоит из двух таблиц:**
    *   **Genuine History Table (GHT):** Содержит записи легитимных транзакций для каждого пользователя.
    *   **Malicious History Table (MHT):** Содержит общие шаблоны выявленных вредоносных транзакций.

**C. Ensemble Learner (Ансамблевый классификатор)**
*   **Цель:** Окончательная классификация транзакций, признанных подозрительными на этапе кластеризации (`OF >= 1`).
*   **Базовые классификаторы:** Используются пять алгоритмов:
    *   Naïve Bayes (NB)
    *   Decision Tree (DT)
    *   Rule Induction (RI)
    *   k-Nearest Neighbors (k-NN)
    *   Radial Basis Function Network (RBFN)
*   **Ансамблевые методы:**
    *   **Bagging:** Обучение одинаковых базовых моделей на разных подвыборках с последующим усреднением или голосованием.
    *   **Boosting:** Последовательное обучение моделей, где каждая следующая исправляет ошибки предыдущей.
    *   **Stacking:** Двухуровневая архитектура. Предсказания разнородных базовых моделей (уровень 0) подаются на вход мета-классификатору (уровень 1) для принятия окончательного решения. Показал наилучшие результаты.

#### **5. Эксперименты и результаты**

**A. Генерация данных**
*   Из-за отсутствия публичных benchmark'ов использовался симулятор транзакций, основанный на TPC-W.
*   Сгенерировано **41 390 транзакций** (нормальные и атакующие).
*   Симулятор включает модули:
    *   **GTGM:** Генерация нормальных транзакций.
    *   **MTGM:** Генерация атакующих транзакций.
    *   **MMPPM:** Управление частотой и смешиванием транзакций.

**B. Настройка OPTICS**
*   Подбирались параметры `MinPts` и `ε`.
*   **Оптимальные параметры:** `MinPts = 10`, `ε = 0`.
*   **Результат:** Наивысшая точность (Precision = 69.90%) и наименьший уровень ложных срабатываний (FPR = 34.73%) на этапе кластеризации.

**C. Сравнение классификаторов и ансамблей**
*   **Индивидуальные классификаторы:** Показали средние результаты.
*   **Ансамбли (Bagging, Boosting):** Значительно улучшили точность и снизили FPR. Наилучшие результаты показали ансамбли на основе **k-NN**.
*   **Stacking:** Показал **наилучший результат** среди всех методов.
    *   **Лучшая конфигурация:** Базовые классификаторы (Naïve Bayes, k-NN, RI, DT) + Мета-классификатор (RBFN).
    *   **Метрики:** Accuracy = 92.17%, Precision = 95.27%, F1-Score = 90.86%, FPR = 3.5%.

**D. Сравнение с существующими подходами**
*   Проведено сравнение с системами **ANFIS-DIDS** (Brahma & Panigrahi, 2015) и **PCA-WRF** (Ronao & Cho, 2016).
*   **Результат:** Предложенная система превзошла оба подхода по всем ключевым метрикам (Accuracy, TPR, FPR).
*   **Дополнительное преимущество:** Меньшая вычислительная сложность, так как большинство нормальных транзакций отсеивается на быстром этапе кластеризации OPTICS, и только подозрительные транзакции проходят через более сложный ансамблевый классификатор.

#### **6. Заключение**
*   Предложена эффективная гибридная система для обнаружения вторжений в БД, сочетающая кластеризацию **OPTICS** и **ансамблевое обучение**.
*   **Ключевые преимущества:**
    *   Высокая точность обнаружения атак.
    *   Низкий уровень ложных срабатываний.
    *   Снижение вычислительной нагрузки за счет двухэтапной обработки.
*   Наилучшие результаты показала конфигурация **Stacking** с RBFN в качестве мета-классификатора.
*   Система демонстрирует превосходство над рассмотренными существующими подходами и является перспективным инструментом для защиты баз данных.

---
